(function(){function n(n){n=n||{};var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push([e,n[e]]);return t}function t(n,t){return t(n),n}function e(n){var t=o.indexOf(n);return-1===t||t<=o.indexOf(l._log_level)?console.log.bind(console,n):s}function r(n){function t(n){try{if(n&&"function"==typeof n.then)return void n.then(t,e);u="resolved",i=n,c&&o(c)}catch(r){e(r)}}function e(n){u="rejected",i=n,c&&o(c)}function o(n){if("pending"===u)return void(c=n);var t=function(){var t;if(t="resolved"===u?n.on_resolved:n.on_rejected,!t)return void("resolved"===u?n.resolve(i):n.reject(i));var e;try{e=t(i)}catch(r){return void n.reject(r)}n.resolve(e)};setImmediate&&"function"==typeof setImmediate?setImmediate(t):process&&process.nextTick&&"function"==typeof process.nextTick?process.nextTick(t):setTimeout(t,1)}var i,u="pending",c=null;this.then=function(n,t){return new r(function(e,r){o({on_resolved:n,on_rejected:t,resolve:e,reject:r})})},this["catch"]=this.then.bind(this,void 0),n(t,e)}var o=["err","warn","info","debug"],i="0.0.1",u=Array.prototype.slice,c=(Object.prototype.toString,Object.prototype.hasOwnProperty,void 0),f=function(n){return u.call(n)},a=function(){p.Promise&&"function"==typeof p.Promise||(p.Promise=r)},s=function(){},l={};l._log_level="debug";var p=function(){if("undefined"!=typeof window)return e("info")("using: window"),window;if("undefined"!=typeof global)return e("info")("using: global"),global;var n="no global found, fail";throw e("err")(n),new Error(n)}();p.S=l,l.install=function(){function n(n,t){for(var e in n)n.hasOwnProperty(e)&&t(n[e],e)}function t(t,r,o){n(r,function(n,r){"function"!=typeof t[r]?(t[r]=n,e("info")("Install",r,"to",o)):e("warn")(r+" exists, uninstalled")})}function r(n,t){t.forEach(function(t){if(!n[t]){var r=n.prototype[t];e("debug")("Generalized",t),"function"==typeof r&&(n[t]=Function.call.bind(r))}})}t(Object,h,"Object"),t(Object.prototype,d,"Object.prototype"),t(Array,m,"Array"),t(Array.prototype,v,"Array.prototype"),r(Array,["join","reverse","sort","push","pop","shift","unshift","splice","concat","slice","indexOf","lastIndexOf","forEach","map","reduce","reduceRight","filter","some","every","find","findIndex","compact","densify","isEmpty","where","exclude"]),t(Function,g,"Function"),t(Function.prototype,y,"Function.prototype"),a()},l.uninstall=function(){};var d={create:function(){var n=function(){};return n.prototype=this,new n},forEach:function(n){var t=Object(this);console.log("this:",this);for(var e in t)t.hasOwnProperty(e)&&n(t[e],e)},tap:function(n){return n(this),this}},h={create:Function.call.bind(d.create),forEach:Function.call.bind(d.forEach),tap:Function.call.bind(d.tap)},y={compose:function(){var n=arguments,t=n.length-1,e=this;return function(){for(var r=t,o=n[t].apply(this,arguments);r--;)o=n[r].call(this,o);return e.call(this,o)}},wrap:function(n){return g.partial(n,this)},once:function(){var n,t=this,e=!1;return function(){return e||(n=t.apply(this,arguments),e=!0),n}},method:function(n,t){return this.prototype[n]?e("warn")("method failure: "+n+"exists."):this.prototype[n]=t,this},curry:function(n){function t(r){return function(){var o=(r||[]).concat(u.call(arguments,0));return o.length<n?t(o):e.apply(this,o)}}var e=this;return n=n||e.length,t()},partial:function(){function n(){var t=this,e=u.call(arguments,0);return function(){for(var r=u.call(arguments,0),o=[],i=0;i<e.length;i++)o[i]=e[i]===n._?r.shift():e[i];return t.apply(this,o.concat(r))}}return n._={},n}(),negate:function(){var n=this;return function(){return!n.apply(null,arguments)}}},g={compose:Function.call.bind(y.compose),partial:t(Function.call.bind(y.partial),function(n){n._=y.partial._}),curry:Function.call.bind(y.curry),negate:Function.call.bind(y.negate),trampoline:function(n){for(;n&&"function"==typeof n;)n=n()},once:Function.call.bind(y.once),wrap:Function.call.bind(y.wrap),noop:function(){}},v={partition:function(n){for(var t=[],e=[],r=0,o=this.length;o>r;r++)n(this[r],r)?t.push(this[r]):e.push(this[r]);return[t,e]},update:function(n,e){return t(this,function(t){t[n]=e})},reductions:function(n,e){return acc=[],this.reduce(g.wrap(n,function(n){return t(n.apply(this,u.call(arguments,1)),function(n){acc.push(n)})}),e),acc},exclude:function(){var n=this,t=u.call(arguments);return n.filter(function(n){return!t.reduce(function(t,e){return t||e===n},!1)})},indexWhere:function(t){function e(n,t){return function(e){return e[n]&&e[n]==t}}var r=n(t).map(function(n){return e(n[0],n[1])});return this.filter(function(n){return r.reduce(function(t,e){return t&&e(n)},!0)}).map(function(n,t){return t})},where:function(t){function e(n,t){return function(e){return e[n]&&e[n]==t}}var r=n(t).map(function(n){return e(n[0],n[1])});return this.filter(function(n){return r.reduce(function(t,e){return t&&e(n)},!0)})},isEmpty:function(){return this===p||l.isNull(this)||0===this.length},first:function(){return this.length>0?this[0]:void 0},last:function(){return this.length>0?this[this.length-1]:void 0},contains:function(n){return-1!==this.indexOf(n)},densify:function(){return this.filter(function(n){return"undefined"!=typeof n})},compact:function(){return this.filter(function(n){return!!n})},find:function(n){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof n)throw new TypeError("predicate must be a function");for(var t,e=Object(this),r=e.length>>>0,o=arguments[1],i=0;r>i;i++)if(t=e[i],n.call(o,t,i,e))return t;return void 0},findIndex:function(n){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof n)throw new TypeError("predicate must be a function");for(var t,e=Object(this),r=e.length>>>0,o=arguments[1],i=0;r>i;i++)if(t=e[i],n.call(o,t,i,e))return i;return-1},pluck:function(n){return this.filter(l.isObject).map(function(n){return n.name})}},m={from:function(){var n=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===n.call(t)},e=function(n){var t=Number(n);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t},r=Math.pow(2,53)-1,o=function(n){var t=e(n);return Math.min(Math.max(t,0),r)};return function(n){var e=this,r=Object(n);if(null==n)throw new TypeError("Array.from requires an array-like object - not null or undefined");var i,u=arguments.length>1?arguments[1]:void 0;if("undefined"!=typeof u){if(!t(u))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(i=arguments[2])}for(var c,f=o(r.length),a=t(e)?Object(new e(f)):new Array(f),s=0;f>s;)c=r[s],a[s]=u?"undefined"==typeof i?u(c,s):u.call(i,c,s):c,s+=1;return a.length=f,a}}(),of:function(){return u.call(arguments)},dim:function(n,t){var e,r=[];for(e=0;n>e;e++)r[e]=t;return r},matrix:function(n,t,e){var r,o,i,u=[];for(o=0;n>o;o++){for(r=[],i=0;t>i;i++)r[i]=e;u[o]=r}return u}};l._log=e,l._DO_NOTHING=s,l.version=i,l._debug=function(){__debug&&console.log("_debug:",arguments)},l._assert=function(n,t){if("undefined"==typeof n||!n)throw""+t},l.pairs=n,l.keys=function(n){l._assert(null!=n,"keys err: obj null");var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t},l.prop=function(n){return function(t){return null==t?c:t[n]}},l.extend=function(){if(arguments.length<1)throw"extend err: arguments.length < 1";var n=arguments[0];if("undefined"==typeof n||null==n)throw new TypeError("extend err: args[0] == null");for(var t=Object(n),e=1;e<arguments.length;e++)arguments[e]!==c&&l.pairs(arguments[e]).forEach(function(n){var e=n[0],r=n[1];t[e]="object"==typeof n[1]?l.extend({},t[e],r):r});return t},l.isUndefined=function(n){return"undefined"==typeof n},l.isObject=function(n){return"object"==typeof n},l.isNull=function(n){return"undefined"==typeof n||null==n},l.notNull=function(n){return"undefined"!=typeof n},l.notEmpty=function(n){switch(typeof n){case"undefined":return!1;case"object":return null!=n;case"string":return n.length>0;default:return!0}},r.resolve=function(n){return new r(function(t){t(n)})},r.all=function(){var n=(f(arguments)||[]).reduce(function(n,t){return t instanceof r?n.push(t):_is_array(t)&&t.forEach(n.push),n},[]);return console.log("debug-all",n),new r(function(t,e){function r(){return!u.some(function(n){return"pending"===n.status})}function o(){r()&&t(u)}function i(n){return{on_resolved:function(t){u[n].status="resolved",u[n].result=t},on_rejected:function(t){u[n].status="rejected",u[n].result=err}}}for(var u=[],c=0;c<n.length;c++){u.push({index:c,status:"pending",result:void 0});var f=i(c);n[c].then(f.on_resolved,f.on_rejected).then(o)}})}}).call(this);